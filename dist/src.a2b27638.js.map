{"version":3,"sources":["../node_modules/rolled/src/syntheticEvents.js","../node_modules/rolled/src/styles.js","../node_modules/rolled/src/index.js","../node_modules/rolled/src/hook/core.js","../node_modules/rolled/src/utils.js","../node_modules/rolled/src/base/reconcile.js","../node_modules/rolled/src/base/reuseNodes.js","../node_modules/rolled/src/hook/event.js","../node_modules/rolled/src/hook/dom.js","../node_modules/rolled/src/hook/taskQueue.js","../node_modules/rolled/src/hook/basic.js","../node_modules/rolled/src/hook/index.js","../node_modules/rolled/src/base/keyed.js","../node_modules/rolled/index.js","src/Component/Assets.js","src/Hooks/Base/Mount.js","src/Hooks/Base/UseEventListener.js","src/Hooks/Base/UseDragDrop.js","src/Component/Base/ImageFactory.js","src/Component/Character/Factory.js","src/Component/Map/Base/Tile.js","src/Component/Config.js","src/Component/Map/Generator/Config.js","src/Component/Map/Generator/Mark.js","src/Component/Map/Generator/Template.js","src/Component/Map/Generator/Biome.js","src/Component/Map/Generator/Base.js","src/Component/Map/Generator/index.js","src/Component/Map/index.js","src/Component/Ui/CharacterGrid.js","src/Component/Ui/Shop.js","src/Component/Game.js","src/index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["generateEvent","name","nativeToSyntheticEvent","event","eventKey","dom","target","eventHandler","undefined","parentNode","CONFIGURED_SYNTHETIC_EVENTS","addEventListener","$dom","fn","setupSyntheticEvent","document","styleElement","createElement","styleSheet","sheet","id","head","appendChild","memorizedStyle","Map","memorizedAnim","styles","stylesObj","selector","classStyles","has","Error","JSON","stringify","ruleIdx","insertRule","cssRules","length","ruleStyle","style","rule","pseudoRuleIdx","pseudoRuleStyle","Object","assign","keyframes","framesObj","frames","framesIdx","framesSheet","percent","appendRule","frameIdx","frameStyle","Ref","constructor","idx","ref","classListNodeType","attributeClassTable","update","value","current","classList","item","nth","replace","add","nodeType","createClassAttribute","create","compilerTemplate","collector","node","refSet","Node","TEXT_NODE","attribute","attributes","size","index","valueMapper","split","rName","slice","removeAttribute","setAttribute","push","mappedValue","nodeData","nodeValue","__default__handler","genPathRecursive","handler","path","indices","root","childNodes","collect","Array","isArray","keys","child","concat","genPath","genFragmentPath","parent","siblings","from","isSameNode","includes","roll","k","walker","refs","x","_refPaths","rolled","extractFragment","strings","args","template","String","raw","innerHTML","content","compile","h","firstChild","fragmentCompile","self","fragmentCollect","fragment","bind","hooksMiddleWare","__Context_Getter","prop","pureValue","Reflect","get","__Context_Apply","thisArg","argumentsList","apply","Context","Proxy","toString","valueOf","Symbol","toPrimitive","convert","StateObject","getter","dispatcher","defineProperties","iterator","LayoutGenError","msg","HookError","hookSymbol","hasHook","component","getHook","setHook","hook","$self","removeHook","useGlobalHook","bindGlobalHook","reduce","accr","initResult","handlers","values","every","v","longestPositiveIncreasingSubsequence","ns","newStart","seq","is","l","pre","i","len","n","j","findGreatestIndexLEQ","lo","hi","mid","Math","floor","noOpUpdate","a","b","reconcile","renderedValues","data","createFn","noOp","beforeNode","afterNode","nextSibling","tmp","removeChild","textContent","mode","insertBefore","prevStart","loop","prevEnd","newEnd","prevStartNode","newStartNode","prevEndNode","previousSibling","lastChild","fixes","_node","next","P","I","set","reusingNodes","toRemove","longestSeq","nodes","tmpC","lisIdx","tmpD","reuseNodes","tail","_head","_mode","lifeCycleSymbol","__generateLifeCycleName","__isLifeCycleEvent","EventError","EVENT_NAME","unMount","mount","watch","SYSTEM_EVENT_NAME","$mount","$unMount","expectEvent","context","eventName","invokeEvent","hookContext","events","boundEvent","clearEvent","splice","onUpdate","key","ATTRIBUTE_NODE","noOpCond","before","updater","old","view","isUpdate","__nestedUpdate__","__bindDom","itemGroup","DOCUMENT_FRAGMENT_NODE","rootChild","call","ELEMENT_NODE","__generateComponent","Promise","isHook","rendered","props","__forceGenerateTags","renderedItems","childs","refCollector","renderer","hoc","__generateChildren","components","Timer","addTimer","removeTimer","timer","boundTask","task","AnimationTimer","window","requestAnimationFrame","cancelAnimationFrame","StateTimer","setTimeout","clearTimeout","IdleTimer","requestIdleCallback","cancelIdleCallback","TaskQueue","tasks","boundExec","exec","param","getAnimationQueue","getTimerQueue","getIdleQueue","stateTask","layoutTask","__channelMap","__stateLayout","initValue","setter","state","temp","__dispatch","val","contextValue","_lazySetter__useEffect","__stateEffect","_lazySetter","_taskQueue","__cycleEffects","cycle","nextCycle","cycleResult","__unMountCycle","isMemo","$children","isMounted","__onMountCycle","$item","invokeReducer","reducer","combineReducers","reducerObject","entryKeys","useState","useLayoutState","useEffect","onCycle","depArray","deps","filter","dep","isChange","el","useContext","useReducer","initState","init","baseState","contextedState","currentState","result","ChannelStruct","ownedContext","useChannel","channel","onObserve","channelObj","reactiveMount","refName","componentTree","reactiveSymbol","for","toLowerCase","refTag","defineProperty","writable","enumerable","configurable","unMountedRef","e","message","memo","memorizedSymbol","arg","LazyComponent","load","loadingComponent","then","LoadedComponent","$parent","__moveHook","remove","loading","__defaultLazy","lazy","resolve","bindHook","children","$slot","useHook","__compileComponent","tagProps","needChild","slot","Infinity","parentElement","hasChildNodes","oldHook","generated","c","__renderObserver","MutationObserver","mutations","mutation","removedNodes","config","childList","subtree","bindDomMutation","observe","render","rootTag","shadow","attachShadow","keyed","syntheticEvents","_syntheticEvents","_styles","_dom","_hook","_renderer","_keyed","_reconcile","_reuseNodes","Characters","Tank","Tiles","Sand","River","Mountain","childMount","Component","channelName","items","setItems","map","cloned","ownedChannelName","useEventListener","domRef","HTMLElement","removeEventListener","useEventListeners","draggedContext","onDragComplete","useDrag","$ref","sendData","onComplete","dataTransfer","setData","useDrop","onDrop","beforeTarget","getData","preventDefault","getImage","group","Collections","Groups","ImageFactory","ImageTemplate","extra","CharacterFactory","CharacterTemplate","Tile","disabled","type","biome","tileClass","tile","classref","setState","CHARACTER_CHANNEL","TILE_CHANNEL","TILE_QUEUE_CHANNEL","SHOP_CHANNEL","MAPInfo","width","height","middleHeight","middleStartHeight","middleEndHeight","bottomStartHeight","bottomEndHeight","victimRectStart","victimRectEnd","playerRectStart","playerRectEnd","ceil","MAP","y","mountain","river","sand","TemplateReducer","createTemplate","defaultTile","Worlds","applyBiome","mapData","random","currentBiome","console","log","defaultFill","mapGenerate","base","createMap","createWorld","generateMap","css","queueData","CharacterGrid","characterName","shopSlot","sampleMockCharacter","lv","Shop","Game","getElementById","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","parse","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","stack","overlay","createErrorOverlay","body","stackTrace","innerText","getParents","modules","parents","d","Function","cached","cache","some","cb"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..\\client","sourcesContent":["const generateEvent = (name) => `__${name}__`;\r\nconst nativeToSyntheticEvent = (event, name) => {\r\n    const eventKey = generateEvent(name);\r\n    let dom = event.target;\r\n    while (dom !== null) {\r\n        const eventHandler = dom[eventKey];\r\n        if (eventHandler) {\r\n            eventHandler(event);\r\n            return undefined;\r\n        }\r\n        dom = dom.parentNode;\r\n    }\r\n};\r\nconst CONFIGURED_SYNTHETIC_EVENTS = {};\r\nexport function addEventListener($dom, name, fn) {\r\n    $dom[generateEvent(name)] = fn;\r\n}\r\nexport function setupSyntheticEvent(name) {\r\n    if (name in CONFIGURED_SYNTHETIC_EVENTS) {\r\n        return;\r\n    }\r\n    // TODO : support multiple events\r\n    document.addEventListener(name, (event) =>\r\n        nativeToSyntheticEvent(event, name)\r\n    );\r\n    CONFIGURED_SYNTHETIC_EVENTS[name] = true;\r\n}\r\n","const styleElement = document.createElement(\"style\");\r\nconst styleSheet = styleElement.sheet;\r\nstyleElement.id = \"rolled-style\";\r\ndocument.head.appendChild(styleElement);\r\n\r\nconst memorizedStyle = new Map();\r\nconst memorizedAnim = new Map();\r\n\r\n// why using css class like ID?\r\n/**\r\n * @param {{ [x: string]: any; }} stylesObj\r\n */\r\nexport function styles(stylesObj) {\r\n    for (let selector in stylesObj) {\r\n        const classStyles = stylesObj[selector];\r\n        if (!memorizedStyle.has(selector)) {\r\n            throw new Error(\r\n                `styles already defined object:${JSON.stringify({\r\n                    [selector]: classStyles\r\n                })}`\r\n            );\r\n        }\r\n        const ruleIdx = styleSheet.insertRule(\r\n            `${selector} {}`,\r\n            styleSheet.cssRules.length\r\n        );\r\n        const ruleStyle = styleSheet.cssRules[ruleIdx].style;\r\n        for (let rule in classStyles) {\r\n            if (rule[0] === \":\" || rule[0] === \" \") {\r\n                const pseudoRuleIdx = styleSheet.insertRule(\r\n                    `${selector}${rule} {}`,\r\n                    styleSheet.cssRules.length\r\n                );\r\n                const pseudoRuleStyle =\r\n                    styleSheet.cssRules[pseudoRuleIdx].style;\r\n                Object.assign(pseudoRuleStyle, classStyles[rule]);\r\n                delete classStyles[rule];\r\n            }\r\n        }\r\n\r\n        Object.assign(ruleStyle, classStyles);\r\n        // well...? it does not need :)\r\n        stylesObj[selector] = selector;\r\n    }\r\n    return stylesObj;\r\n}\r\n// TODO : return \r\nexport function keyframes(framesObj) {\r\n    for (let name in framesObj) {\r\n        const frames = framesObj[name];\r\n        if (!memorizedAnim.has(name)) {\r\n            throw new Error(\r\n                `styles already defined object:${JSON.stringify({\r\n                    [name]: frames\r\n                })}`\r\n            );\r\n        }\r\n        const framesIdx = styleSheet.insertRule(\r\n            `@keyframes ${name} {}`,\r\n            styleSheet.cssRules.length\r\n        );\r\n        const framesSheet = styleSheet.cssRules[framesIdx];\r\n\r\n        for (let percent in frames) {\r\n            framesSheet.appendRule(`${percent}% {}`);\r\n            const frameIdx = framesSheet.cssRules.length - 1;\r\n            const frameStyle = framesSheet.cssRules[frameIdx].style;\r\n            Object.assign(frameStyle, frames[percent]);\r\n        }\r\n    }\r\n    return framesObj;\r\n}\r\n\r\nexport default styles;\r\n","class Ref {\r\n    constructor(idx, ref) {\r\n        this.idx = idx;\r\n        this.ref = ref;\r\n    }\r\n}\r\nexport const classListNodeType = \"classList\";\r\nconst attributeClassTable = {\r\n    update(value) {\r\n        const current = this.classList.item(this.nth);\r\n        if (current.length > 0) {\r\n            this.classList.replace(current, value);\r\n        } else {\r\n            this.classList.add(value);\r\n            this.nth = this.classList.length - 1;\r\n        }\r\n    },\r\n    nodeType: classListNodeType,\r\n};\r\nconst createClassAttribute = (classList, nth) =>\r\n    Object.assign(Object.create(null), { classList, nth }, attributeClassTable);\r\n\r\nconst compilerTemplate = document.createElement(\"template\");\r\nconst collector = (node) => {\r\n    const refSet = [];\r\n    if (node.nodeType !== Node.TEXT_NODE) {\r\n        const attribute = node.attributes;\r\n        const size = attribute.length;\r\n        if (attribute !== undefined) {\r\n            for (let index = 0; index < size; index++) {\r\n                const { name, value } = attribute[index];\r\n                const valueMapper =\r\n                    name === \"class\" ? value.split(\" \") : [value];\r\n                if (name[0] === \"#\") {\r\n                    let rName = name.slice(1);\r\n                    node.removeAttribute(name);\r\n                    // todo: legacy & remove\r\n                    node.setAttribute(rName, \"\");\r\n                    refSet.push(name.slice(1));\r\n                }\r\n                for (let index = 0; index < valueMapper.length; index++) {\r\n                    const mappedValue = valueMapper[index];\r\n                    if (mappedValue[0] === \"#\") {\r\n                        // captured\r\n                        refSet.push(\r\n                            Object.assign(mappedValue.slice(1), {\r\n                                nth: index,\r\n                                name,\r\n                            })\r\n                        );\r\n                    }\r\n                }\r\n                // TODO: attribute mapper\r\n            }\r\n        }\r\n    } else {\r\n        const nodeData = node.nodeValue;\r\n        if (nodeData[0] === \"#\") {\r\n            node.nodeValue = \"\";\r\n            refSet.push(nodeData.slice(1));\r\n        }\r\n    }\r\n    return refSet;\r\n};\r\n\r\nconst __default__handler = () => false;\r\nconst genPathRecursive = (\r\n    node,\r\n    handler = __default__handler,\r\n    path = [],\r\n    indices = [],\r\n    root = node\r\n) => {\r\n    const childNodes = node.childNodes;\r\n    const collect = collector(node);\r\n    if (Array.isArray(collect) && collect.length > 0) {\r\n        for (let index = 0; index < collect.length; index++) {\r\n            indices.push(new Ref(path, collect[index]));\r\n        }\r\n    }\r\n    for (const idx of childNodes.keys()) {\r\n        const child = childNodes[idx];\r\n        genPathRecursive(child, handler, path.concat(idx), indices, node);\r\n        if (handler() || __default__handler()) {\r\n            break;\r\n        }\r\n    }\r\n    return indices;\r\n};\r\nconst genPath = (node, handler = __default__handler) => {\r\n    return genPathRecursive(node, handler);\r\n};\r\nconst genFragmentPath = (node) => {\r\n    const parent = node.parentNode;\r\n    const siblings = parent !== null ? Array.from(parent.childNodes) : [];\r\n    return genPath(\r\n        node,\r\n        () => !node.isSameNode(node) && siblings.includes(node)\r\n    );\r\n};\r\nconst roll = (node, idx) => {\r\n    for (const k of idx) {\r\n        node = node.childNodes[k];\r\n    }\r\n    return node;\r\n};\r\n\r\nfunction walker(node = this) {\r\n    const refs = {};\r\n    for (const x of this._refPaths) {\r\n        const ref = x.ref;\r\n        const idx = x.idx;\r\n        const rolled = roll(node, idx);\r\n        refs[ref] =\r\n            typeof ref === \"object\"\r\n                ? ref.name === \"class\"\r\n                    ? createClassAttribute(rolled.classList, ref.nth)\r\n                    : rolled.attributes[ref.name]\r\n                : rolled;\r\n    }\r\n    return refs;\r\n}\r\nexport const extractFragment = (strings, ...args) => {\r\n    const template = String.raw(strings, ...args)\r\n        .replace(/>\\n+/g, \">\")\r\n        .replace(/\\s+</g, \"<\")\r\n        .replace(/>\\s+/g, \">\")\r\n        .replace(/\\n\\s+/g, \"\");\r\n    // .replace(/\\n\\s+/g, \"<!-- -->\");\r\n    compilerTemplate.innerHTML = template;\r\n    return compilerTemplate.content;\r\n};\r\nconst compile = (node) => {\r\n    node._refPaths = genPath(node);\r\n    node.collect = walker;\r\n};\r\nexport const h = (strings, ...args) => {\r\n    const content = extractFragment(strings, ...args).firstChild;\r\n    compile(content);\r\n    return content;\r\n};\r\n\r\nconst fragmentCompile = (node) => {\r\n    for (const self of node.childNodes) {\r\n        self._refPaths = genFragmentPath(self);\r\n        self.collect = walker;\r\n    }\r\n};\r\nconst fragmentCollect = function (node = this) {\r\n    const refs = {};\r\n    for (const self of node.childNodes) {\r\n        Object.assign(refs, self.collect(self));\r\n    }\r\n    return refs;\r\n};\r\nexport const fragment = (strings, ...args) => {\r\n    const content = extractFragment(strings, ...args);\r\n    fragmentCompile(content);\r\n    content.collect = fragmentCollect.bind({\r\n        childNodes: Array.from(content.childNodes),\r\n    });\r\n    return content;\r\n};\r\nexport default h;\r\n","export const hooksMiddleWare = [];\r\nconst __Context_Getter = (target, prop) => {\r\n    const pureValue = target.value;\r\n    return Reflect.get(\r\n        prop in target\r\n            ? target\r\n            : typeof pureValue === \"object\" && prop in pureValue\r\n            ? target.value\r\n            : target,\r\n        prop\r\n    );\r\n};\r\nconst __Context_Apply = (target, thisArg, argumentsList) =>\r\n    Reflect.apply(target, thisArg, argumentsList);\r\nexport class Context {\r\n    constructor(value, nth) {\r\n        this.value = value;\r\n        this.nth = nth;\r\n        return new Proxy(this, {\r\n            get: __Context_Getter,\r\n            apply: __Context_Apply,\r\n        });\r\n    }\r\n    toString() {\r\n        return this.value.toString();\r\n    }\r\n    valueOf() {\r\n        return this.value;\r\n    }\r\n    [Symbol.toPrimitive]() {\r\n        return this.value;\r\n    }\r\n    static convert(value, nth) {\r\n        return new Context(value, nth);\r\n    }\r\n}\r\nexport class StateObject {\r\n    constructor(getter, dispatcher) {\r\n        Object.defineProperties(this, {\r\n            0: {\r\n                get: getter,\r\n            },\r\n            1: {\r\n                get: () => dispatcher,\r\n            },\r\n            length: {\r\n                value: 2,\r\n            },\r\n        });\r\n    }\r\n    *[Symbol.iterator]() {\r\n        yield this[0];\r\n        yield this[1];\r\n    }\r\n}\r\n\r\n// Errors\r\nexport class LayoutGenError extends Error {\r\n    constructor(msg) {\r\n        super(msg);\r\n    }\r\n}\r\n\r\nexport class HookError extends Error {\r\n    constructor(...args) {\r\n        super(...args);\r\n    }\r\n}\r\n//hook\r\nexport const hookSymbol = Symbol(\"@@Hook\");\r\nexport function hasHook(component) {\r\n    return hookSymbol in component;\r\n}\r\nexport function getHook(component) {\r\n    return component[hookSymbol];\r\n}\r\nexport function setHook(component, hook) {\r\n    hook.$self = component;\r\n    return (component[hookSymbol] = hook);\r\n}\r\nexport function removeHook(component) {\r\n    let hook = component[hookSymbol];\r\n    delete hook.$self;\r\n    delete component[hookSymbol];\r\n    hook = null;\r\n}\r\nexport function useGlobalHook(hook) {\r\n    if (typeof hook !== \"function\") {\r\n        throw new HookError(\"custom hook middleware is must function\");\r\n    }\r\n    hooksMiddleWare.push(hook);\r\n}\r\nexport function bindGlobalHook(hook) {\r\n    return hooksMiddleWare.reduce((accr, handler) => {\r\n        const initResult = handler(hook) || {};\r\n        const handlers = Object.values(initResult);\r\n        if (\r\n            typeof initResult === \"object\" &&\r\n            handlers.every((v) => typeof v === \"function\")\r\n        ) {\r\n            Object.assign(accr, initResult);\r\n        } else {\r\n            throw new HookError(\r\n                \"custom hook middleware result is must object & each element is must function\"\r\n            );\r\n        }\r\n        return accr;\r\n    }, {});\r\n}\r\n","\r\n// Picked from\r\n// https://github.com/adamhaile/surplus/blob/master/src/runtime/content.ts#L368\r\n\r\n// return an array of the indices of ns that comprise the longest increasing subsequence within ns\r\nexport function longestPositiveIncreasingSubsequence(ns, newStart) {\r\n    var seq = [],\r\n        is  = [],\r\n        l   = -1,\r\n        pre = new Array(ns.length);\r\n\r\n    for (var i = newStart, len = ns.length; i < len; i++) {\r\n        var n = ns[i];\r\n        if (n < 0) continue;\r\n        var j = findGreatestIndexLEQ(seq, n);\r\n        if (j !== -1) pre[i] = is[j];\r\n        if (j === l) {\r\n            l++;\r\n            seq[l] = n;\r\n            is[l]  = i;\r\n        } else if (n < seq[j + 1]) {\r\n            seq[j + 1] = n;\r\n            is[j + 1] = i;\r\n        }\r\n    }\r\n\r\n    for (i = is[l]; l >= 0; i = pre[i], l--) {\r\n        seq[l] = i;\r\n    }\r\n\r\n    return seq;\r\n}\r\n\r\nfunction findGreatestIndexLEQ(seq, n) {\r\n    // invariant: lo is guaranteed to be index of a value <= n, hi to be >\r\n    // therefore, they actually start out of range: (-1, last + 1)\r\n    var lo = -1,\r\n        hi = seq.length;\r\n\r\n    // fast path for simple increasing sequences\r\n    if (hi > 0 && seq[hi - 1] <= n) return hi - 1;\r\n\r\n    while (hi - lo > 1) {\r\n        var mid = Math.floor((lo + hi) / 2);\r\n        if (seq[mid] > n) {\r\n            hi = mid;\r\n        } else {\r\n            lo = mid;\r\n        }\r\n    }\r\n\r\n    return lo;\r\n}\r\n// just for utils\r\nexport const noOpUpdate = (a, b) => {};","import { noOpUpdate, longestPositiveIncreasingSubsequence } from \"../utils.js\";\r\n\r\n// This is almost straightforward implementation of reconcillation algorithm\r\n// based on ivi documentation:\r\n// https://github.com/localvoid/ivi/blob/2c81ead934b9128e092cc2a5ef2d3cabc73cb5dd/packages/ivi/src/vdom/implementation.ts#L1366\r\n// With some fast paths from Surplus implementation:\r\n// https://github.com/adamhaile/surplus/blob/master/src/runtime/content.ts#L86\r\n//\r\n// How this implementation differs from others, is that it's working with data directly,\r\n// without maintaining nodes arrays, and uses dom props firstChild/lastChild/nextSibling\r\n// for markers moving.\r\nexport function reconcile(\r\n    parent,\r\n    renderedValues,\r\n    data,\r\n    createFn,\r\n    noOp = noOpUpdate,\r\n    beforeNode,\r\n    afterNode\r\n) {\r\n    // Fast path for clear\r\n    if (data.length === 0) {\r\n        if (beforeNode !== undefined || afterNode !== undefined) {\r\n            let node =\r\n                    beforeNode !== undefined\r\n                        ? beforeNode.nextSibling\r\n                        : parent.firstChild,\r\n                tmp;\r\n\r\n            if (afterNode === undefined) afterNode = null;\r\n\r\n            while (node !== afterNode) {\r\n                tmp = node.nextSibling;\r\n                parent.removeChild(node);\r\n                node = tmp;\r\n            }\r\n        } else {\r\n            parent.textContent = \"\";\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Fast path for create\r\n    if (renderedValues.length === 0) {\r\n        let node,\r\n            mode = afterNode !== undefined ? 1 : 0;\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n            node = createFn(data[i], i);\r\n            mode\r\n                ? parent.insertBefore(node, afterNode)\r\n                : parent.appendChild(node);\r\n        }\r\n        return;\r\n    }\r\n\r\n    let prevStart = 0,\r\n        newStart = 0,\r\n        loop = true,\r\n        prevEnd = renderedValues.length - 1,\r\n        newEnd = data.length - 1,\r\n        a,\r\n        b,\r\n        prevStartNode = beforeNode ? beforeNode.nextSibling : parent.firstChild,\r\n        newStartNode = prevStartNode,\r\n        prevEndNode = afterNode ? afterNode.previousSibling : parent.lastChild;\r\n\r\n    fixes: while (loop) {\r\n        loop = false;\r\n        let _node;\r\n\r\n        // Skip prefix\r\n        (a = renderedValues[prevStart]), (b = data[newStart]);\r\n        while (a === b) {\r\n            noOp(prevStartNode, b);\r\n            prevStart++;\r\n            newStart++;\r\n            newStartNode = prevStartNode = prevStartNode.nextSibling;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevStart];\r\n            b = data[newStart];\r\n        }\r\n\r\n        // Skip suffix\r\n        (a = renderedValues[prevEnd]), (b = data[newEnd]);\r\n        while (a === b) {\r\n            noOp(prevEndNode, b);\r\n            prevEnd--;\r\n            newEnd--;\r\n            afterNode = prevEndNode;\r\n            prevEndNode = prevEndNode.previousSibling;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevEnd];\r\n            b = data[newEnd];\r\n        }\r\n\r\n        // Fast path to swap backward\r\n        (a = renderedValues[prevEnd]), (b = data[newStart]);\r\n        while (a === b) {\r\n            loop = true;\r\n            noOp(prevEndNode, b);\r\n            _node = prevEndNode.previousSibling;\r\n            parent.insertBefore(prevEndNode, newStartNode);\r\n            prevEndNode = _node;\r\n            newStart++;\r\n            prevEnd--;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevEnd];\r\n            b = data[newStart];\r\n        }\r\n\r\n        // Fast path to swap forward\r\n        (a = renderedValues[prevStart]), (b = data[newEnd]);\r\n        while (a === b) {\r\n            loop = true;\r\n            noOp(prevStartNode, b);\r\n            _node = prevStartNode.nextSibling;\r\n            parent.insertBefore(prevStartNode, afterNode);\r\n            prevStart++;\r\n            afterNode = prevStartNode;\r\n            prevStartNode = _node;\r\n            newEnd--;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevStart];\r\n            b = data[newEnd];\r\n        }\r\n    }\r\n\r\n    // Fast path for shrink\r\n    if (newEnd < newStart) {\r\n        if (prevStart <= prevEnd) {\r\n            let next;\r\n            while (prevStart <= prevEnd) {\r\n                if (prevEnd === 0) {\r\n                    parent.removeChild(prevEndNode);\r\n                } else {\r\n                    next = prevEndNode.previousSibling;\r\n                    parent.removeChild(prevEndNode);\r\n                    prevEndNode = next;\r\n                }\r\n                prevEnd--;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Fast path for add\r\n    if (prevEnd < prevStart) {\r\n        if (newStart <= newEnd) {\r\n            let node,\r\n                mode = afterNode ? 1 : 0;\r\n            while (newStart <= newEnd) {\r\n                node = createFn(data[newStart], newStart);\r\n                mode\r\n                    ? parent.insertBefore(node, afterNode)\r\n                    : parent.appendChild(node);\r\n                newStart++;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Positions for reusing nodes from current DOM state\r\n    const P = new Array(newEnd + 1 - newStart);\r\n    for (let i = newStart; i <= newEnd; i++) P[i] = -1;\r\n\r\n    // Index to resolve position from current to new\r\n    const I = new Map();\r\n    for (let i = newStart; i <= newEnd; i++) I.set(data[i], i);\r\n\r\n    let reusingNodes = newStart + data.length - 1 - newEnd,\r\n        toRemove = [];\r\n\r\n    for (let i = prevStart; i <= prevEnd; i++) {\r\n        if (I.has(renderedValues[i])) {\r\n            P[I.get(renderedValues[i])] = i;\r\n            reusingNodes++;\r\n        } else {\r\n            toRemove.push(i);\r\n        }\r\n    }\r\n\r\n    // Fast path for full replace\r\n    if (reusingNodes === 0) {\r\n        if (beforeNode !== undefined || afterNode !== undefined) {\r\n            let node =\r\n                    beforeNode !== undefined\r\n                        ? beforeNode.nextSibling\r\n                        : parent.firstChild,\r\n                tmp;\r\n\r\n            if (afterNode === undefined) afterNode = null;\r\n\r\n            while (node !== afterNode) {\r\n                tmp = node.nextSibling;\r\n                parent.removeChild(node);\r\n                node = tmp;\r\n                prevStart++;\r\n            }\r\n        } else {\r\n            parent.textContent = \"\";\r\n        }\r\n\r\n        let node,\r\n            mode = afterNode ? 1 : 0;\r\n        for (let i = newStart; i <= newEnd; i++) {\r\n            node = createFn(data[i], i);\r\n            mode\r\n                ? parent.insertBefore(node, afterNode)\r\n                : parent.appendChild(node);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    // What else?\r\n    const longestSeq = longestPositiveIncreasingSubsequence(P, newStart);\r\n\r\n    // Collect nodes to work with them\r\n    const nodes = [];\r\n    let tmpC = prevStartNode;\r\n    for (let i = prevStart; i <= prevEnd; i++) {\r\n        nodes[i] = tmpC;\r\n        tmpC = tmpC.nextSibling;\r\n    }\r\n\r\n    for (let i = 0; i < toRemove.length; i++)\r\n        parent.removeChild(nodes[toRemove[i]]);\r\n\r\n    let lisIdx = longestSeq.length - 1,\r\n        tmpD;\r\n    for (let i = newEnd; i >= newStart; i--) {\r\n        if (longestSeq[lisIdx] === i) {\r\n            afterNode = nodes[P[longestSeq[lisIdx]]];\r\n            noOp(afterNode, data[i]);\r\n            lisIdx--;\r\n        } else {\r\n            if (P[i] === -1) {\r\n                tmpD = createFn(data[i], i);\r\n            } else {\r\n                tmpD = nodes[P[i]];\r\n                noOp(tmpD, data[i]);\r\n            }\r\n            parent.insertBefore(tmpD, afterNode);\r\n            afterNode = tmpD;\r\n        }\r\n    }\r\n}\r\n\r\nexport default reconcile;\r\n","import { noOpUpdate } from \"../utils.js\";\r\n\r\nexport function reuseNodes(\r\n    parent,\r\n    renderedValues,\r\n    data,\r\n    createFn,\r\n    noOp = noOpUpdate,\r\n    beforeNode,\r\n    afterNode\r\n) {\r\n    if (data.length === 0) {\r\n        if (beforeNode !== undefined || afterNode !== undefined) {\r\n            let node =\r\n                    beforeNode !== undefined\r\n                        ? beforeNode.nextSibling\r\n                        : parent.firstChild,\r\n                tmp;\r\n\r\n            if (afterNode === undefined) afterNode = null;\r\n\r\n            while (node !== afterNode) {\r\n                tmp = node.nextSibling;\r\n                parent.removeChild(node);\r\n                node = tmp;\r\n            }\r\n        } else {\r\n            parent.textContent = \"\";\r\n        }\r\n        return;\r\n    }\r\n    if (renderedValues.length > data.length) {\r\n        let i = renderedValues.length,\r\n            tail =\r\n                afterNode !== undefined\r\n                    ? afterNode.previousSibling\r\n                    : parent.lastChild,\r\n            tmp;\r\n        while (i > data.length) {\r\n            tmp = tail.previousSibling;\r\n            parent.removeChild(tail);\r\n            tail = tmp;\r\n            i--;\r\n        }\r\n    }\r\n\r\n    let _head = beforeNode ? beforeNode.nextSibling : parent.firstChild;\r\n    if (_head === afterNode) _head = undefined;\r\n\r\n    let _mode = afterNode ? 1 : 0;\r\n    for (let i = 0, item, head = _head, mode = _mode; i < data.length; i++) {\r\n        item = data[i];\r\n        if (head) {\r\n            noOp(head, item);\r\n        } else {\r\n            head = createFn(item, i);\r\n            mode\r\n                ? parent.insertBefore(head, afterNode)\r\n                : parent.appendChild(head);\r\n        }\r\n        head = head.nextSibling;\r\n        if (head === afterNode) head = null;\r\n    }\r\n}\r\nexport default reuseNodes;\r\n","const lifeCycleSymbol = \"$\";\r\nfunction __generateLifeCycleName(name) {\r\n    return lifeCycleSymbol + name;\r\n}\r\nfunction __isLifeCycleEvent(name) {\r\n    return name[0] === lifeCycleSymbol;\r\n}\r\nexport class EventError extends Error {\r\n    constructor(...args) {\r\n        super(...args);\r\n    }\r\n}\r\nexport const EVENT_NAME = {\r\n    unMount: \"unMount\",\r\n    mount: \"mount\",\r\n    watch: Symbol(\"WATCHED_EVENT\"),\r\n};\r\nexport const SYSTEM_EVENT_NAME = {\r\n    $mount: __generateLifeCycleName(\"mount\"),\r\n    $unMount: __generateLifeCycleName(\"unMount\"),\r\n};\r\nexport function expectEvent(context, eventName) {\r\n    if (\r\n        context &&\r\n        typeof context === \"object\" &&\r\n        context !== null &&\r\n        (eventName in EVENT_NAME || eventName in SYSTEM_EVENT_NAME)\r\n    ) {\r\n        return;\r\n    }\r\n    throw new EventError(`${eventName.toString()} is not supported Event`);\r\n}\r\nexport function invokeEvent(hookContext, eventName) {\r\n    expectEvent(hookContext, eventName);\r\n    const events = hookContext.events;\r\n    const item = events[eventName];\r\n    if (typeof item === \"function\") {\r\n        return item(hookContext);\r\n    }\r\n    if (Array.isArray(item)) {\r\n        for (let index = 0; index < item.length; index++) {\r\n            item[index](hookContext);\r\n        }\r\n    }\r\n    if (!__isLifeCycleEvent(eventName)) {\r\n        invokeEvent(hookContext, lifeCycleSymbol + eventName);\r\n    }\r\n}\r\nexport function boundEvent(context, eventName, value) {\r\n    expectEvent(context, eventName);\r\n    const events = context.events;\r\n    const item = events[eventName];\r\n    if (Array.isArray(item)) {\r\n        //TODO: use scheduler task\r\n        if (typeof value === \"function\") {\r\n            item.push(value);\r\n        } else {\r\n            throw new EventError(`event is must function!!!`);\r\n        }\r\n    } else {\r\n        events[eventName] = value;\r\n    }\r\n}\r\nexport function clearEvent(context, eventName) {\r\n    expectEvent(context, eventName);\r\n    const events = context.events;\r\n    const item = events[eventName];\r\n    if (Array.isArray(item)) {\r\n        item.splice(0);\r\n    } else {\r\n        events[eventName] = () => {};\r\n    }\r\n}\r\n","import { hasHook, getHook, LayoutGenError } from \"./core.js\";\r\nimport { reconcile } from \"../base/reconcile.js\";\r\nimport { reuseNodes } from \"../base/reuseNodes.js\";\r\nimport { classListNodeType } from \"../index.js\";\r\nimport { invokeEvent } from \"./event.js\";\r\nconst onUpdate = (node, current, key) => {\r\n    switch (node.nodeType) {\r\n        // case Node.ELEMENT_NODE:\r\n        //     node.setAttribute(key, current);\r\n        //     break;\r\n        case Node.TEXT_NODE:\r\n        case Node.ATTRIBUTE_NODE:\r\n            node.nodeValue = current;\r\n            break;\r\n        case classListNodeType:\r\n            node.update(current);\r\n            break;\r\n        default:\r\n            throw new LayoutGenError(\"unaccepted data\");\r\n    }\r\n};\r\nconst noOpCond = (current, before) => true;\r\nconst valueOf = (value) =>\r\n    typeof value === \"object\" ? value.valueOf() : value;\r\nconst updater = (old, view, isUpdate = noOpCond) => {\r\n    //needs bound self\r\n    return function __nestedUpdate__(item) {\r\n        const collector = view.collect(this);\r\n        for (const key in collector) {\r\n            const current = valueOf(item[key]);\r\n            const before = valueOf(old[key]);\r\n            if (current !== before && isUpdate(current, before)) {\r\n                onUpdate(collector[key], current, key);\r\n                old[key] = current;\r\n            }\r\n        }\r\n    };\r\n};\r\nexport const __bindDom = ({ ...item }, itemGroup) => {\r\n    switch (itemGroup.nodeType) {\r\n        case Node.DOCUMENT_FRAGMENT_NODE:\r\n            let rootChild = itemGroup.firstChild;\r\n            if (rootChild !== null) {\r\n                do {\r\n                    rootChild.update = updater(item, rootChild);\r\n                    updater({}, rootChild).call(rootChild, item);\r\n                } while ((rootChild = rootChild.nextSibling));\r\n            }\r\n            break;\r\n        case Node.ELEMENT_NODE:\r\n            itemGroup.update = updater(item, itemGroup);\r\n            updater({}, itemGroup).call(itemGroup, item);\r\n            break;\r\n        default:\r\n            throw new LayoutGenError(\"unacceptable nodes\");\r\n    }\r\n    return itemGroup;\r\n};\r\nexport const __generateComponent = (item, component) => {\r\n    let view = component(item);\r\n    if (view instanceof Promise) {\r\n        throw new LayoutGenError(\"lazy is not Promise (use rolled.lazy)\");\r\n    }\r\n    const hook = getHook(view);\r\n    const isHook = hasHook(view);\r\n    const rendered = __bindDom(isHook ? hook.props : item, view);\r\n    if (isHook) {\r\n        invokeEvent(getHook(view), \"mount\");\r\n    }\r\n    return rendered;\r\n};\r\nexport const __forceGenerateTags = (\r\n    parent,\r\n    renderedItems,\r\n    childs,\r\n    refCollector = [],\r\n    renderer = reconcile\r\n) => {\r\n    renderer(\r\n        parent,\r\n        renderedItems,\r\n        childs,\r\n        (hoc, nth) => {\r\n            const view = __generateComponent({}, hoc);\r\n            // tricky solution\r\n            // @ts-ignore\r\n            if (view.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\r\n                throw new LayoutGenError(\"slot is must not fragment\");\r\n            }\r\n            refCollector.splice(nth, 0, view);\r\n            return view;\r\n        },\r\n        (node, item) => node.update(item)\r\n    );\r\n    return refCollector;\r\n};\r\nexport const __generateChildren = (parent, childs, renderer = reconcile) => {\r\n    let renderedItems = [];\r\n    let components = [];\r\n    if (Array.isArray(childs)) {\r\n        if (!(\"update\" in parent)) {\r\n            parent.update = function (data) {\r\n                renderer(\r\n                    parent,\r\n                    renderedItems,\r\n                    childs,\r\n                    (hoc, nth) => {\r\n                        const view = __generateComponent({}, hoc);\r\n                        components[nth] = view;\r\n                        return view;\r\n                    },\r\n                    (node, item) => node.update(item)\r\n                );\r\n                renderedItems = childs.slice();\r\n            };\r\n        }\r\n        parent.update(childs.slice());\r\n    }\r\n    return components;\r\n};\r\n","class Timer {\r\n    // @ts-ignore\r\n    constructor(addTimer, removeTimer) {\r\n        this.timer = -1;\r\n        this.addTimer = addTimer;\r\n        this.removeTimer = removeTimer;\r\n    }\r\n    boundTask(task) {\r\n        if (this.timer >= 0) {\r\n            this.removeTimer(this.timer);\r\n        }\r\n        this.timer = this.addTimer(task);\r\n    }\r\n}\r\nclass AnimationTimer extends Timer {\r\n    constructor() {\r\n        super(\r\n            (fn) => window.requestAnimationFrame(fn),\r\n            (timer) => window.cancelAnimationFrame(timer)\r\n        );\r\n    }\r\n}\r\nclass StateTimer extends Timer {\r\n    constructor() {\r\n        super(\r\n            (fn) => window.setTimeout(fn, 0),\r\n            (timer) => window.clearTimeout(timer)\r\n        );\r\n    }\r\n}\r\nclass IdleTimer extends Timer {\r\n    constructor() {\r\n        super(\r\n            (fn) => window.requestIdleCallback(fn),\r\n            (timer) => window.cancelIdleCallback(timer)\r\n        );\r\n    }\r\n}\r\nclass TaskQueue {\r\n    constructor(timer) {\r\n        this.tasks = [];\r\n        this.timer = timer;\r\n        this.boundExec = this.exec.bind(this);\r\n    }\r\n    add(task, ...param) {\r\n        if (typeof task !== \"function\") {\r\n            //@TODO: taskQueue must contains Own Error\r\n            throw new Error(\"[TaskQueue] Task is must Function\");\r\n        }\r\n        this.tasks.push({ task, param });\r\n        this.timer.boundTask(this.boundExec);\r\n    }\r\n    exec() {\r\n        for (const { task, param } of this.tasks.splice(0)) {\r\n            task(...param);\r\n        }\r\n    }\r\n}\r\n\r\nexport const getAnimationQueue = () => new TaskQueue(new AnimationTimer());\r\nexport const getTimerQueue = () => new TaskQueue(new StateTimer());\r\nexport const getIdleQueue = () => new TaskQueue(new IdleTimer());\r\n","import {\r\n    __generateChildren,\r\n    __generateComponent,\r\n    __bindDom,\r\n    __forceGenerateTags,\r\n} from \"./dom.js\";\r\nimport {\r\n    HookError,\r\n    LayoutGenError,\r\n    StateObject,\r\n    Context,\r\n    hasHook,\r\n    getHook,\r\n    removeHook,\r\n    bindGlobalHook,\r\n    setHook,\r\n} from \"./core.js\";\r\nimport { h } from \"../index.js\";\r\nimport { getAnimationQueue, getTimerQueue, getIdleQueue } from \"./taskQueue.js\";\r\nimport {\r\n    invokeEvent,\r\n    EVENT_NAME,\r\n    clearEvent,\r\n    boundEvent,\r\n    SYSTEM_EVENT_NAME,\r\n} from \"./event.js\";\r\n\r\n//d.ts  migrate\r\nexport * from \"./core.js\";\r\nexport * from \"./event.js\";\r\nconst stateTask = getIdleQueue();\r\nconst layoutTask = getAnimationQueue();\r\nconst __channelMap = new Map();\r\n\r\n//effects layout\r\nfunction __stateLayout(context, initValue, setter) {\r\n    const nth = context.state.length;\r\n    const temp = new StateObject(\r\n        () => context.state[nth],\r\n        function __dispatch(val) {\r\n            if (Array.isArray(context.state)) {\r\n                let value = val instanceof Context ? val.value : val;\r\n                let contextValue = context.state[nth];\r\n                contextValue.value = value;\r\n                if (typeof setter === \"function\") {\r\n                    setter(contextValue);\r\n                }\r\n            } else {\r\n                throw new Error(\"dispatch only actived Context\");\r\n            }\r\n        }\r\n    );\r\n    if (!(nth in context.state)) {\r\n        context.state[nth] = Context.convert(initValue || undefined, nth);\r\n    }\r\n    return temp;\r\n}\r\nfunction _lazySetter__useEffect(value) {\r\n    return value;\r\n}\r\nfunction __stateEffect(\r\n    context,\r\n    initValue,\r\n    _lazySetter = typeof initValue === \"function\"\r\n        ? initValue\r\n        : _lazySetter__useEffect,\r\n    _taskQueue = stateTask\r\n) {\r\n    return __stateLayout(context, initValue, (contextValue) => {\r\n        _taskQueue.add(() => {\r\n            contextValue.value = _lazySetter(contextValue.value);\r\n            invokeEvent(context, EVENT_NAME.mount);\r\n        });\r\n        return contextValue;\r\n    });\r\n}\r\n//cycle\r\nfunction __cycleEffects(cycle, nextCycle) {\r\n    let cycleResult = null;\r\n    if (typeof cycle === \"function\") {\r\n        cycleResult = cycle(nextCycle);\r\n    }\r\n    if (typeof nextCycle === \"function\") {\r\n        nextCycle(cycleResult);\r\n    }\r\n}\r\nfunction __unMountCycle(context) {\r\n    return () => {\r\n        if (!context.isMemo) {\r\n            for (const k of Object.keys(EVENT_NAME)) {\r\n                clearEvent(context, k);\r\n            }\r\n            context.state.splice(0);\r\n            for (const child of context.$children.splice(0)) {\r\n                if (hasHook(child)) {\r\n                    invokeEvent(getHook(child), EVENT_NAME.unMount);\r\n                }\r\n            }\r\n            removeHook(context.$self);\r\n            for (const k in context) {\r\n                delete context[k];\r\n            }\r\n        }\r\n        context.isMounted = false;\r\n    };\r\n}\r\nfunction __onMountCycle(context) {\r\n    return () => {\r\n        const $dom = context.$dom;\r\n        for (const $item of $dom) {\r\n            $item.update(context.props);\r\n        }\r\n        context.isMounted = true;\r\n    };\r\n}\r\nfunction invokeReducer(reducer, state = {}, param = {}) {\r\n    return reducer(state, param);\r\n}\r\nexport function combineReducers(reducerObject) {\r\n    const entryKeys = Object.keys(reducerObject);\r\n    return () => {\r\n        const temp = Object.create(null);\r\n        for (let index = 0; index < entryKeys.length; index++) {\r\n            const key = entryKeys[index];\r\n            temp[key] = invokeReducer(reducerObject[key]);\r\n        }\r\n        return temp;\r\n    };\r\n}\r\n// hooks\r\nexport function useState(context, initValue, _lazySetter) {\r\n    const state = __stateEffect(context, initValue, _lazySetter);\r\n    // const __dispatch = state[1];\r\n    // __dispatch(initValue);\r\n    return state;\r\n}\r\nexport function useLayoutState(context, initValue, _lazySetter) {\r\n    const state = __stateEffect(context, initValue, _lazySetter, layoutTask);\r\n    const __dispatch = state[1];\r\n    __dispatch(initValue);\r\n    return state;\r\n}\r\nexport function useEffect(context, onCycle, depArray = []) {\r\n    if (!Array.isArray(depArray)) {\r\n        throw new HookError(\"dep is must Array or null\");\r\n    }\r\n    const deps = depArray.filter((dep) => dep instanceof Context);\r\n    const event = (context) => {\r\n        const isChange = context.isMounted\r\n            ? // \r\n              !depArray.every((el, nth) => el.value === deps[nth])\r\n            : true;\r\n\r\n        if (isChange) {\r\n            __cycleEffects(onCycle, (unMount) => {\r\n                typeof unMount === \"function\" &&\r\n                    boundEvent(context, EVENT_NAME.unMount, unMount);\r\n            });\r\n        }\r\n    };\r\n    boundEvent(context, EVENT_NAME.mount, event);\r\n}\r\nexport function useContext(value) {\r\n    return Context.convert(value);\r\n}\r\n\r\nexport function useReducer(context, reducer, initState, init) {\r\n    const baseState = typeof init === \"function\" ? init(initState) : initState;\r\n    const contextedState = __stateEffect(context, baseState);\r\n    const [currentState, __dispatch] = contextedState;\r\n    const dispatcher = (param) => {\r\n        const result = invokeReducer(reducer, currentState, param);\r\n        __dispatch(result);\r\n    };\r\n    return new StateObject(() => currentState, dispatcher);\r\n}\r\n// export function useMemo(context, onCycle, deps) {}\r\n\r\n//gc   \r\nclass ChannelStruct extends Array {\r\n    constructor(context, initValue) {\r\n        super();\r\n        this.ownedContext = context;\r\n        this.state = useState(context, initValue);\r\n    }\r\n}\r\nexport function useChannel(context, channel, initValue = null, onObserve) {\r\n    let channelObj = null;\r\n    if (!__channelMap.has(channel)) {\r\n        const channelObj = new ChannelStruct(context, initValue);\r\n        useEffect(\r\n            context,\r\n            () => {\r\n                const [state] = channelObj.state;\r\n                for (let index = 0; index < channelObj.length; index++) {\r\n                    const handler = channelObj[index];\r\n                    handler(state.value);\r\n                }\r\n                return () => {};\r\n            },\r\n            [channelObj.state[0]]\r\n        );\r\n        __channelMap.set(channel, channelObj);\r\n    }\r\n    channelObj = __channelMap.get(channel);\r\n    if (typeof onObserve === \"function\") {\r\n        channelObj.push(onObserve);\r\n    }\r\n    // state  context    context   effect  \r\n    //     UB     \r\n    return channelObj.state;\r\n}\r\n//generic dom util\r\nexport function reactiveMount(context, refName, componentTree) {\r\n    if (context.$self === null) {\r\n        throw new LayoutGenError(\"current context is not mounted dom\");\r\n    }\r\n    const refs = context.$self.collect();\r\n    const reactiveSymbol = Symbol.for(`@@reactiveMountedTag`);\r\n    refName = refName.toLowerCase();\r\n    if (!(refName in refs)) {\r\n        throw new LayoutGenError(`Ref \"${refName}\" must contains component`);\r\n    }\r\n    if (!Array.isArray(componentTree)) {\r\n        throw new LayoutGenError(`ComponentTree is must Array`);\r\n    }\r\n    const refTag = refs[refName];\r\n    if (!Array.isArray(refTag[reactiveSymbol])) {\r\n        Object.defineProperty(refTag, reactiveSymbol, {\r\n            writable: false,\r\n            enumerable: false,\r\n            configurable: false,\r\n            value: [],\r\n        });\r\n    }\r\n    const renderedItems = refTag[reactiveSymbol];\r\n    try {\r\n        const unMountedRef = renderedItems.splice(\r\n            0,\r\n            renderedItems.length,\r\n            ...__forceGenerateTags(\r\n                refTag,\r\n                refTag[reactiveSymbol],\r\n                componentTree\r\n            )\r\n        );\r\n    } catch (e) {\r\n        if (e instanceof LayoutGenError) {\r\n            throw new LayoutGenError(`[ReactiveMount] ${e.message}`);\r\n        }\r\n    }\r\n}\r\n\r\n//hook utils\r\nexport function memo(component, memorizedSymbol = Symbol.for(\"@@Memo\")) {\r\n    if (typeof component !== \"function\") {\r\n        throw new Error(`memorized component should be function`);\r\n    }\r\n    // TODO: use Map\r\n    if (typeof component[memorizedSymbol] !== \"object\") {\r\n        component[memorizedSymbol] = new Map();\r\n    }\r\n    return (...arg) => {\r\n        const memo = component[memorizedSymbol];\r\n        //  serialize \r\n        const key = JSON.stringify(arg);\r\n        if (memo.has(key)) {\r\n            return memo.get(key);\r\n        } else {\r\n            const value = component(...arg);\r\n            if (hasHook(value)) {\r\n                getHook(value).isMemo = true;\r\n            }\r\n            memo.set(key, value);\r\n            return value;\r\n        }\r\n    };\r\n}\r\nexport class LazyComponent {\r\n    constructor(load, loadingComponent) {\r\n        load.then((LoadedComponent) => {\r\n            const $parent = this.current.parentNode;\r\n            const isHook = hasHook(this.current);\r\n            const hook = isHook ? getHook(this.current) : null;\r\n            let current = isHook\r\n                ? __moveHook(hook, LoadedComponent)\r\n                : LoadedComponent(...this.props);\r\n            $parent.insertBefore(current, this.current);\r\n            this.current.remove();\r\n            this.current = current;\r\n        });\r\n        if (typeof loadingComponent !== \"function\") {\r\n            throw new LayoutGenError(\"loading component must function\");\r\n        }\r\n        this.loading = (...args) => {\r\n            this.props = args;\r\n            return (this.current = loadingComponent(...args));\r\n        };\r\n    }\r\n}\r\nfunction __defaultLazy() {\r\n    //TODO: generate component\r\n    return h`<div style=\"display:none;\"></div>`;\r\n}\r\nexport function lazy(load, loading = __defaultLazy) {\r\n    return new LazyComponent(Promise.resolve(load()), loading);\r\n}\r\n//bound hooks\r\nexport function bindHook(props = {}, children) {\r\n    const hookContext = {\r\n        state: [],\r\n        props,\r\n        children,\r\n        isMemo: false,\r\n        isMounted: false,\r\n        $dom: [],\r\n        $children: [],\r\n        $self: null,\r\n        $slot: null,\r\n        events: {\r\n            [EVENT_NAME.mount]: [],\r\n            [EVENT_NAME.unMount]: [],\r\n            [SYSTEM_EVENT_NAME.$mount]: [],\r\n            [SYSTEM_EVENT_NAME.$unMount]: [],\r\n            [EVENT_NAME.watch]: [],\r\n        },\r\n        useState(value) {\r\n            return useState(hookContext, value);\r\n        },\r\n        useEffect(...arg) {\r\n            return useEffect(hookContext, ...arg);\r\n        },\r\n        useReducer(...arg) {\r\n            return useReducer(hookContext, ...arg);\r\n        },\r\n        useHook(fn) {\r\n            return Object.assign(hookContext, fn(hookContext));\r\n        },\r\n        useChannel(channel, initValue, onObserve) {\r\n            return useChannel(hookContext, channel, initValue, onObserve);\r\n        },\r\n        reactiveMount(refName, componentTree) {\r\n            return reactiveMount(hookContext, refName, componentTree);\r\n        },\r\n    };\r\n    const events = hookContext.events;\r\n    events[SYSTEM_EVENT_NAME.$mount].push(__onMountCycle(hookContext));\r\n    events[SYSTEM_EVENT_NAME.$unMount].push(__unMountCycle(hookContext));\r\n    return Object.assign(hookContext, bindGlobalHook(hookContext));\r\n}\r\nexport function __compileComponent(component, tagProps, hookContext, children) {\r\n    const current = component(tagProps, hookContext);\r\n    const needChild = Array.isArray(children);\r\n    if (!(current instanceof Node)) {\r\n        throw new HookError(\"render function is must node\");\r\n    }\r\n    if (current.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\r\n        hookContext.$dom = Array.from(current.childNodes);\r\n        if (needChild && children.length > 0) {\r\n            throw new HookError(\"fragment-child is not support\");\r\n        }\r\n    } else {\r\n        hookContext.$dom = [current];\r\n        if (needChild) {\r\n            let slot = current.collect().children;\r\n            switch (\r\n                typeof slot === \"object\" && \"nodeType\" in slot\r\n                    ? slot.nodeType\r\n                    : -Infinity\r\n            ) {\r\n                case Node.TEXT_NODE:\r\n                    let parent = slot.parentElement;\r\n                    slot.remove();\r\n                    slot = parent;\r\n                    if (slot.hasChildNodes()) {\r\n                        throw new LayoutGenError(\r\n                            \"fragemnt-layout-generate is yet supported\"\r\n                        );\r\n                    }\r\n                    break;\r\n                case Node.ELEMENT_NODE:\r\n                    break;\r\n                default:\r\n                    slot = current;\r\n                    break;\r\n            }\r\n            hookContext.$slot = slot;\r\n            hookContext.$children = __generateChildren(slot, children);\r\n        }\r\n    }\r\n    return current;\r\n}\r\nfunction __moveHook(oldHook, component) {\r\n    const generated = __bindDom(\r\n        { ...oldHook.props },\r\n        c(component, oldHook.props, oldHook.children)()\r\n    );\r\n    return generated;\r\n}\r\nexport const c = (component, props = {}, children) => {\r\n    const hoc = (item) => {\r\n        const tagProps = { ...props };\r\n        const hookContext = bindHook(tagProps, children);\r\n        const current = __compileComponent(\r\n            component instanceof LazyComponent ? component.loading : component,\r\n            tagProps,\r\n            hookContext,\r\n            children\r\n        );\r\n        setHook(current, hookContext);\r\n        return current;\r\n    };\r\n    return hoc;\r\n};\r\n","import { __generateComponent } from \"./dom.js\";\r\nimport { reuseNodes } from \"../base/reuseNodes.js\";\r\nimport { getHook, hasHook, invokeEvent } from \"./basic.js\";\r\nimport { fragment, h } from \"../index.js\";\r\n\r\n//JUST global render do not duplicated renderer\r\nconst __renderObserver = new MutationObserver((mutations) => {\r\n    for (const mutation of mutations) {\r\n        const { removedNodes } = mutation;\r\n        if (removedNodes.length > 0) {\r\n            for (const node of removedNodes) {\r\n                if (hasHook(node)) {\r\n                    invokeEvent(getHook(node), \"unMount\");\r\n                }\r\n                delete node.update;\r\n                // TODO : unMount ref logic from './index.js'\r\n            }\r\n        }\r\n    }\r\n});\r\nconst config = {\r\n    childList: true,\r\n    subtree: true,\r\n};\r\nconst bindDomMutation = (parent) => {\r\n    __renderObserver.observe(parent, config);\r\n    return parent;\r\n};\r\nexport const render = (parent, component) => {\r\n    let renderedItems = [];\r\n    bindDomMutation(parent);\r\n    parent.update = function (data) {\r\n        reuseNodes(\r\n            parent,\r\n            renderedItems,\r\n            data,\r\n            (item) => __generateComponent(item, component),\r\n            (node, item) => node.update(item)\r\n        );\r\n        renderedItems = data.slice();\r\n    };\r\n    parent.update([{}]);\r\n    return parent;\r\n};\r\n\r\nconst rootTag = \"div\";\r\nexport const shadow = (strings, ...args) => {\r\n    //1.tree iterate parent  \r\n    //   ref iterate \r\n    //   root ref \r\n    //\r\n    //2. fragment\r\n    //   root   \r\n    //  root child-zone \r\n    //        \r\n    //   fragment root  \r\n    const result = fragment(strings, ...args);\r\n    const root = document.createElement(rootTag);\r\n    const shadow = root.attachShadow({ mode: \"open\" });\r\n    bindDomMutation(shadow);\r\n    shadow.appendChild(result);\r\n    root.collect = ($dom = result) => result.collect.call(null, shadow);\r\n    return root;\r\n};\r\n","import { noOpUpdate, longestPositiveIncreasingSubsequence } from \"../utils.js\";\r\n\r\n// This is almost straightforward implementation of reconcillation algorithm\r\n// based on ivi documentation:\r\n// https://github.com/localvoid/ivi/blob/2c81ead934b9128e092cc2a5ef2d3cabc73cb5dd/packages/ivi/src/vdom/implementation.ts#L1366\r\n// With some fast paths from Surplus implementation:\r\n// https://github.com/adamhaile/surplus/blob/master/src/runtime/content.ts#L86\r\n//\r\n// How this implementation differs from others, is that it's working with data directly,\r\n// without maintaining nodes arrays, and uses dom props firstChild/lastChild/nextSibling\r\n// for markers moving.\r\nexport function keyed(\r\n    key,\r\n    parent,\r\n    renderedValues,\r\n    data,\r\n    createFn,\r\n    noOp = noOpUpdate,\r\n    beforeNode,\r\n    afterNode\r\n) {\r\n    // Fast path for clear\r\n    if (data.length === 0) {\r\n        if (beforeNode !== undefined || afterNode !== undefined) {\r\n            let node =\r\n                    beforeNode !== undefined\r\n                        ? beforeNode.nextSibling\r\n                        : parent.firstChild,\r\n                tmp;\r\n\r\n            if (afterNode === undefined) afterNode = null;\r\n\r\n            while (node !== afterNode) {\r\n                tmp = node.nextSibling;\r\n                parent.removeChild(node);\r\n                node = tmp;\r\n            }\r\n        } else {\r\n            parent.textContent = \"\";\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Fast path for create\r\n    if (renderedValues.length === 0) {\r\n        let node,\r\n            mode = afterNode !== undefined ? 1 : 0;\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n            node = createFn(data[i], i);\r\n            mode\r\n                ? parent.insertBefore(node, afterNode)\r\n                : parent.appendChild(node);\r\n        }\r\n        return;\r\n    }\r\n\r\n    let prevStart = 0,\r\n        newStart = 0,\r\n        loop = true,\r\n        prevEnd = renderedValues.length - 1,\r\n        newEnd = data.length - 1,\r\n        a,\r\n        b,\r\n        prevStartNode = beforeNode ? beforeNode.nextSibling : parent.firstChild,\r\n        newStartNode = prevStartNode,\r\n        prevEndNode = afterNode ? afterNode.previousSibling : parent.lastChild;\r\n\r\n    fixes: while (loop) {\r\n        loop = false;\r\n        let _node;\r\n\r\n        // Skip prefix\r\n        (a = renderedValues[prevStart]), (b = data[newStart]);\r\n        while (a[key] === b[key]) {\r\n            noOp(prevStartNode, b);\r\n            prevStart++;\r\n            newStart++;\r\n            newStartNode = prevStartNode = prevStartNode.nextSibling;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevStart];\r\n            b = data[newStart];\r\n        }\r\n\r\n        // Skip suffix\r\n        (a = renderedValues[prevEnd]), (b = data[newEnd]);\r\n        while (a[key] === b[key]) {\r\n            noOp(prevEndNode, b);\r\n            prevEnd--;\r\n            newEnd--;\r\n            afterNode = prevEndNode;\r\n            prevEndNode = prevEndNode.previousSibling;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevEnd];\r\n            b = data[newEnd];\r\n        }\r\n\r\n        // Fast path to swap backward\r\n        (a = renderedValues[prevEnd]), (b = data[newStart]);\r\n        while (a[key] === b[key]) {\r\n            loop = true;\r\n            noOp(prevEndNode, b);\r\n            _node = prevEndNode.previousSibling;\r\n            parent.insertBefore(prevEndNode, newStartNode);\r\n            prevEndNode = _node;\r\n            newStart++;\r\n            prevEnd--;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevEnd];\r\n            b = data[newStart];\r\n        }\r\n\r\n        // Fast path to swap forward\r\n        (a = renderedValues[prevStart]), (b = data[newEnd]);\r\n        while (a[key] === b[key]) {\r\n            loop = true;\r\n            noOp(prevStartNode, b);\r\n            _node = prevStartNode.nextSibling;\r\n            parent.insertBefore(prevStartNode, afterNode);\r\n            prevStart++;\r\n            afterNode = prevStartNode;\r\n            prevStartNode = _node;\r\n            newEnd--;\r\n            if (prevEnd < prevStart || newEnd < newStart) break fixes;\r\n            a = renderedValues[prevStart];\r\n            b = data[newEnd];\r\n        }\r\n    }\r\n\r\n    // Fast path for shrink\r\n    if (newEnd < newStart) {\r\n        if (prevStart <= prevEnd) {\r\n            let next;\r\n            while (prevStart <= prevEnd) {\r\n                if (prevEnd === 0) {\r\n                    parent.removeChild(prevEndNode);\r\n                } else {\r\n                    next = prevEndNode.previousSibling;\r\n                    parent.removeChild(prevEndNode);\r\n                    prevEndNode = next;\r\n                }\r\n                prevEnd--;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Fast path for add\r\n    if (prevEnd < prevStart) {\r\n        if (newStart <= newEnd) {\r\n            let node,\r\n                mode = afterNode ? 1 : 0;\r\n            while (newStart <= newEnd) {\r\n                node = createFn(data[newStart], newStart);\r\n                mode\r\n                    ? parent.insertBefore(node, afterNode)\r\n                    : parent.appendChild(node);\r\n                newStart++;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    // Positions for reusing nodes from current DOM state\r\n    const P = new Array(newEnd + 1 - newStart);\r\n    for (let i = newStart; i <= newEnd; i++) P[i] = -1;\r\n\r\n    // Index to resolve position from current to new\r\n    const I = new Map();\r\n    for (let i = newStart; i <= newEnd; i++) I.set(data[i][key], i);\r\n\r\n    let reusingNodes = newStart + data.length - 1 - newEnd,\r\n        toRemove = [];\r\n\r\n    for (let i = prevStart; i <= prevEnd; i++) {\r\n        if (I.has(renderedValues[i][key])) {\r\n            P[I.get(renderedValues[i][key])] = i;\r\n            reusingNodes++;\r\n        } else {\r\n            toRemove.push(i);\r\n        }\r\n    }\r\n\r\n    // Fast path for full replace\r\n    if (reusingNodes === 0) {\r\n        if (beforeNode !== undefined || afterNode !== undefined) {\r\n            let node =\r\n                    beforeNode !== undefined\r\n                        ? beforeNode.nextSibling\r\n                        : parent.firstChild,\r\n                tmp;\r\n\r\n            if (afterNode === undefined) afterNode = null;\r\n\r\n            while (node !== afterNode) {\r\n                tmp = node.nextSibling;\r\n                parent.removeChild(node);\r\n                node = tmp;\r\n                prevStart++;\r\n            }\r\n        } else {\r\n            parent.textContent = \"\";\r\n        }\r\n\r\n        let node,\r\n            mode = afterNode ? 1 : 0;\r\n        for (let i = newStart; i <= newEnd; i++) {\r\n            node = createFn(data[i], i);\r\n            mode\r\n                ? parent.insertBefore(node, afterNode)\r\n                : parent.appendChild(node);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    // What else?\r\n    const longestSeq = longestPositiveIncreasingSubsequence(P, newStart);\r\n\r\n    // Collect nodes to work with them\r\n    const nodes = [];\r\n    let tmpC = prevStartNode;\r\n    for (let i = prevStart; i <= prevEnd; i++) {\r\n        nodes[i] = tmpC;\r\n        tmpC = tmpC.nextSibling;\r\n    }\r\n\r\n    for (let i = 0; i < toRemove.length; i++)\r\n        parent.removeChild(nodes[toRemove[i]]);\r\n\r\n    let lisIdx = longestSeq.length - 1,\r\n        tmpD;\r\n    for (let i = newEnd; i >= newStart; i--) {\r\n        if (longestSeq[lisIdx] === i) {\r\n            afterNode = nodes[P[longestSeq[lisIdx]]];\r\n            noOp(afterNode, data[i]);\r\n            lisIdx--;\r\n        } else {\r\n            if (P[i] === -1) {\r\n                tmpD = createFn(data[i], i);\r\n            } else {\r\n                tmpD = nodes[P[i]];\r\n                noOp(tmpD, data[i]);\r\n            }\r\n            parent.insertBefore(tmpD, afterNode);\r\n            afterNode = tmpD;\r\n        }\r\n    }\r\n}\r\n\r\nexport default keyed;\r\n","import * as _syntheticEvents from \"./src/syntheticEvents.js\";\r\nimport * as _styles from \"./src/styles.js\";\r\nimport * as _dom from \"./src/index.js\";\r\nimport * as _hook from \"./src/hook/basic.js\";\r\nimport * as _renderer from \"./src/hook/index.js\";\r\nimport * as _keyed from \"./src/base/keyed.js\";\r\nimport * as _reconcile from \"./src/base/reconcile.js\";\r\nimport * as _reuseNodes from \"./src/base/reuseNodes.js\";\r\n\r\nexport const syntheticEvents = _syntheticEvents;\r\nexport const styles = _styles;\r\nexport const dom = _dom;\r\nexport const hook = _hook;\r\nexport const renderer = _renderer;\r\nexport const keyed = _keyed;\r\nexport const reconcile = _reconcile;\r\nexport const reuseNodes = _reuseNodes;\r\nexport default {\r\n    syntheticEvents,\r\n    styles,\r\n    dom,\r\n    hook,\r\n    renderer,\r\n    keyed,\r\n    reconcile,\r\n    reuseNodes\r\n};\r\n","// @ts-ignore\r\nimport Tank from \"../Assets/Img/Character/Tank.svg\";\r\n// @ts-ignore\r\nimport Sand from \"../Assets/Img/Tile/Sand.svg\";\r\n// @ts-ignore\r\nimport River from \"../Assets/Img/Tile/River.svg\";\r\n// @ts-ignore\r\nimport Mountain from \"../Assets/Img/Tile/Mountain.svg\";\r\n\r\nexport const Characters = {\r\n  Tank,\r\n};\r\nexport const Tiles = {\r\n  Sand,\r\n  River,\r\n  Mountain,\r\n};\r\n","import { hook } from \"rolled\";\r\nimport {\r\n    useChannel,\r\n    useEffect,\r\n    useState,\r\n    reactiveMount,\r\n} from \"rolled/src/hook/basic\";\r\nconst { c } = hook;\r\nexport const childMount = (\r\n    context,\r\n    refName,\r\n    Component,\r\n    channelName = refName,\r\n    initValue = []\r\n) => {\r\n    const state = useChannel(context, channelName, initValue, () => {});\r\n    const [items, setItems] = state;\r\n    useEffect(\r\n        context,\r\n        () => {\r\n            reactiveMount(\r\n                context,\r\n                refName,\r\n                items.value.map((item, nth) => {\r\n                    return c(\r\n                        (props, ownedContext) => {\r\n                            ownedContext.useHook(() => ({\r\n                                update: (item) => {\r\n                                    const cloned = [...items.value];\r\n                                    cloned.splice(nth, 1, item);\r\n                                    setItems(cloned);\r\n                                },\r\n                                remove: () => {\r\n                                    const cloned = [...items.value];\r\n                                    cloned.splice(nth, 1);\r\n                                    setItems(cloned);\r\n                                },\r\n                                ownedChannelName: channelName,\r\n                            }));\r\n                            return Component(props, ownedContext);\r\n                        },\r\n                        { ...item },\r\n                        null\r\n                    );\r\n                })\r\n            );\r\n        },\r\n        [items]\r\n    );\r\n    return state;\r\n};\r\nexport const mount = (context) => ({\r\n    childMount: (refName, Component, channelName = refName) => {\r\n        return childMount(context, refName, Component, channelName);\r\n    },\r\n});\r\nexport default mount;\r\n","import { hook } from \"rolled\";\r\nconst { c } = hook;\r\nexport const useEventListener = (context, domRef, eventName, handler) => {\r\n    context.useEffect(() => {\r\n        if (!(domRef instanceof HTMLElement)) {\r\n            throw new Error(\"domRef is must HTMLElement\");\r\n        }\r\n        domRef.addEventListener(eventName, handler);\r\n        return () => {\r\n            domRef.removeEventListener(eventName, handler);\r\n        };\r\n    }, []);\r\n};\r\nexport const useEventListeners = (context, refSet) => {\r\n    context.useEffect(() => {\r\n        for (const [ref, eventName, handler] of refSet) {\r\n            if (!(ref instanceof HTMLElement)) {\r\n                throw new Error(\"domRef is must HTMLElement\");\r\n            }\r\n            ref.addEventListener(eventName, handler);\r\n        }\r\n        return () => {\r\n            for (const [ref, eventName, handler] of refSet) {\r\n                ref.removeEventListener(eventName, handler);\r\n            }\r\n        };\r\n    }, []);\r\n};\r\nexport const mount = (context) => ({\r\n    useEventListener: (refName, Component, channelName = refName) => {\r\n        return useEventListener(context, refName, Component, channelName);\r\n    },\r\n});\r\nexport default mount;\r\n","import { hook } from \"rolled\";\r\nimport { useEventListeners } from \"./UseEventListener.js\";\r\nimport { Context } from \"rolled/src/hook/basic\";\r\nlet draggedContext = null;\r\nlet onDragComplete = null;\r\n/**\r\n * @template T\r\n * @param {import(\"rolled/src/hook/basic\").HookContext<T>} context\r\n * @param {import(\"rolled/src\").hElement} $ref\r\n * @param {() => string} sendData\r\n * @param {(context: import(\"rolled/src/hook/basic\").HookContext<T>) => void} onComplete\r\n */\r\nexport const useDrag = (context, $ref, sendData, onComplete) => {\r\n    useEventListeners(context, [\r\n        [\r\n            $ref,\r\n            \"dragstart\",\r\n            (e) => {\r\n                e.dataTransfer.setData(\"text/plain\", sendData());\r\n            },\r\n        ],\r\n        [\r\n            $ref,\r\n            \"dragover\",\r\n            (e) => {\r\n                draggedContext = context;\r\n                onDragComplete = onComplete;\r\n            },\r\n        ],\r\n    ]);\r\n};\r\nexport const useDrop = (context, $ref, onDrop, beforeTarget) => {\r\n    useEventListeners(context, [\r\n        [\r\n            $ref,\r\n            \"drop\",\r\n            (e) => {\r\n                const data = e.dataTransfer.getData(\"text/plain\");\r\n                if (data.length > 0) {\r\n                    onDrop(data);\r\n                    onDragComplete(draggedContext);\r\n                    draggedContext = null;\r\n                    onDragComplete = null;\r\n                }\r\n            },\r\n        ],\r\n        [\r\n            $ref,\r\n            \"dragover\",\r\n            (e) => {\r\n                if (beforeTarget()) {\r\n                    e.preventDefault();\r\n                }\r\n            },\r\n        ],\r\n    ]);\r\n};\r\n","import { h } from \"rolled/src\";\r\nimport * as Groups from \"../Assets.js\";\r\nimport { Context } from \"rolled/src/hook/basic\";\r\nconst getImage = (name, group) => {\r\n    const Collections = Groups[group];\r\n    if (typeof Collections !== \"object\") {\r\n        throw new Error(`Collections is not object`);\r\n    }\r\n    if (!(name in Collections)) {\r\n        throw new Error(`${name} is not included Collection`);\r\n    }\r\n    return Collections[name];\r\n};\r\n/**\r\n * @typedef {{name: string, group: keyof Groups| string, extra: string}} FactoryTemplate\r\n * @param {FactoryTemplate} props\r\n * @param {Context<FactoryTemplate>} context\r\n */\r\nexport const ImageFactory = (props, context) => {\r\n    const $dom = h`${ImageTemplate(props.name, props.group, props.extra)}`;\r\n    props[\"path\"] = getImage(props.name, props.group);\r\n    return $dom;\r\n};\r\n/**\r\n *\r\n * @param {string} name\r\n * @param {string} group\r\n * @param {string} extra\r\n */\r\nexport const ImageTemplate = (name, group, extra) => {\r\n    return `<img src=\"${getImage(name, group)}\" ${extra}/>`;\r\n};\r\nexport default ImageFactory;\r\n","import { h } from \"rolled/src\";\r\nimport { Characters } from \"../Assets.js\";\r\nimport { useDrag } from \"../../Hooks/Base/UseDragDrop.js\";\r\nimport { ImageFactory, ImageTemplate } from \"../Base/ImageFactory.js\";\r\nexport const CharacterFactory = (props, context) => {\r\n    const $dom = ImageFactory(\r\n        { ...props, group: \"Characters\", extra: \"draggable\" },\r\n        context\r\n    );\r\n    useDrag(\r\n        context,\r\n        $dom,\r\n        () => props.name,\r\n        (context) => {\r\n            // @ts-ignore\r\n            context.remove();\r\n        }\r\n    );\r\n    return $dom;\r\n};\r\nexport const CharacterTemplate = (name) =>\r\n    ImageTemplate(name, \"Characters\", \"draggable\");\r\nexport default CharacterFactory;\r\n","import { dom, syntheticEvents, hook } from \"rolled\";\r\n\r\nimport { Tiles } from \"../../Assets.js\";\r\nimport { childMount } from \"../../../Hooks/Base/Mount.js\";\r\nimport { CharacterFactory } from \"../../Character/Factory.js\";\r\nimport { useDrop } from \"../../../Hooks/Base/UseDragDrop.js\";\r\nimport { ImageTemplate } from \"../../Base/ImageFactory.js\";\r\n\r\nconst { getHook } = hook;\r\nconst { setupSyntheticEvent, addEventListener } = syntheticEvents;\r\nconst { fragment, h } = dom;\r\n\r\n// setupSyntheticEvent(\"drop\");\r\n// setupSyntheticEvent(\"dragover\");\r\nexport const Tile = ({ disabled, type, nth, biome }, context) => {\r\n    const tileClass = disabled\r\n        ? \"disabled\"\r\n        : type === \"player\"\r\n        ? \"player\"\r\n        : \"victim\";\r\n    const $dom = h`\r\n        <div class=\"hex #classref\">\r\n            <div class=\"hex-item\" #tile>\r\n            </div>\r\n            ${\r\n                typeof biome === \"string\" && type\r\n                    ? ImageTemplate(biome, \"Tiles\", `class=\"hex-biome\"`)\r\n                    : \"\"\r\n            }\r\n        </div>\r\n    `;\r\n    const { tile, classref } = $dom.collect();\r\n    classref.update(tileClass);\r\n    if (!disabled && type === \"player\") {\r\n        const [state, setState] = childMount(\r\n            context,\r\n            \"tile\",\r\n            CharacterFactory,\r\n            `${nth}/${context.ownedChannelName}/Character`\r\n        );\r\n        useDrop(\r\n            context,\r\n            tile,\r\n            (name) => {\r\n                setState([{ name }]);\r\n            },\r\n            () => state.value.length === 0\r\n        );\r\n    }\r\n    return $dom;\r\n};\r\nexport default Tile;\r\n","export const CHARACTER_CHANNEL = \"character\";\r\nexport const TILE_CHANNEL = \"tile\";\r\nexport const TILE_QUEUE_CHANNEL = \"tile/queue\";\r\nexport const SHOP_CHANNEL = \"shop\";\r\n","const MAPInfo = {\r\n    width: 16,\r\n    height: 11,\r\n    middleHeight: 0,\r\n    middleStartHeight: 0,\r\n    middleEndHeight: 0,\r\n    bottomStartHeight: 0,\r\n    bottomEndHeight: 0,\r\n    victimRectStart: 0,\r\n    victimRectEnd: 0,\r\n    playerRectStart: 0,\r\n    playerRectEnd: 0,\r\n};\r\nMAPInfo.middleHeight = Math.ceil(MAPInfo.height / 2);\r\n\r\nMAPInfo.middleStartHeight = MAPInfo.width * (MAPInfo.middleHeight - 1) - 1;\r\nMAPInfo.middleEndHeight = MAPInfo.width * MAPInfo.middleHeight;\r\n\r\nMAPInfo.bottomStartHeight = MAPInfo.width * (MAPInfo.height - 1) - 1;\r\nMAPInfo.bottomEndHeight = MAPInfo.width * MAPInfo.height;\r\n\r\nMAPInfo.playerRectStart = MAPInfo.middleEndHeight;\r\nMAPInfo.playerRectEnd = MAPInfo.bottomStartHeight;\r\n\r\nMAPInfo.victimRectStart = MAPInfo.width;\r\nMAPInfo.victimRectEnd = MAPInfo.middleStartHeight;\r\nexport const MAP = {\r\n    ...MAPInfo,\r\n};\r\nexport default { MAP };\r\n","import { Tiles } from \"../../Assets\";\r\n\r\nexport const biome = (biome, x, y) => {\r\n    if (!(biome in Tiles)) {\r\n        throw new Error(`${biome} is not contains Biome Marked Tile`);\r\n    }\r\n    return { biome, x, y };\r\n};\r\nexport const mountain = (x, y) => biome(\"Mountain\", x, y);\r\nexport const river = (x, y) => biome(\"River\", x, y);\r\nexport const sand = (x, y) => biome(\"Sand\", x, y);\r\n","import { mountain as mountainBiome, river as riverBiome } from \"./Mark.js\";\r\nexport const river = (x, y) => {\r\n    return [\r\n        riverBiome(x, y),\r\n        riverBiome(x, y + 1),\r\n        riverBiome(x, y + 2),\r\n        riverBiome(x, y + 3),\r\n    ];\r\n};\r\nexport const mountain = (x, y) => {\r\n    return [\r\n        mountainBiome(x, y),\r\n        mountainBiome(x + 1, y),\r\n        mountainBiome(x, y + 1),\r\n        mountainBiome(x + 1, y + 1),\r\n        ...river(x, y + 2),\r\n    ];\r\n};\r\n","import { mountain, river } from \"./Template.js\";\r\nimport { sand } from \"./Mark.js\";\r\nimport { MAP } from \"./Config.js\";\r\nfunction TemplateReducer(accr, { x, y, biome }) {\r\n    if (!(y in accr)) {\r\n        accr[y] = {};\r\n    }\r\n    accr[y][x] = biome;\r\n    return accr;\r\n}\r\nfunction createTemplate(defaultTile, ...map) {\r\n    return {\r\n        tile: defaultTile,\r\n        biome: map.reduce(TemplateReducer, {}),\r\n    };\r\n}\r\nexport const Worlds = [\r\n    createTemplate(sand, ...mountain(5, 0)),\r\n    createTemplate(sand, ...river(0, 0)),\r\n];\r\nexport function applyBiome(mapData) {\r\n    const map = [...mapData];\r\n    const { tile, biome } = Worlds[Math.floor(Math.random() * Worlds.length)];\r\n    for (let index = 0; index < map.length; index++) {\r\n        const item = map[index];\r\n        const x = index % MAP.width;\r\n        const y = Math.floor(index / MAP.width);\r\n        const currentBiome =\r\n            y in biome && x in biome[y] ? biome[y][x] : tile(x, y).biome;\r\n        Object.assign(item, {\r\n            biome: currentBiome,\r\n        });\r\n    }\r\n    console.log(map);\r\n    return map;\r\n}\r\n","import { MAP } from \"./Config\";\r\n\r\nconst defaultFill = () => Object.create(null);\r\nfunction mapGenerate(v, k) {\r\n    // victim\r\n    const base = {\r\n        nth: k,\r\n        disabled: false,\r\n    };\r\n    if (MAP.playerRectStart <= k && k <= MAP.playerRectEnd) {\r\n        base.type = \"player\";\r\n    }\r\n    if (MAP.victimRectStart <= k && k <= MAP.victimRectEnd) {\r\n        base.type = \"victim\";\r\n    }\r\n    if (\r\n        k < MAP.width ||\r\n        (MAP.middleStartHeight < k && k < MAP.middleEndHeight) ||\r\n        (MAP.bottomStartHeight < k && k < MAP.bottomEndHeight)\r\n    ) {\r\n        base.disabled = true;\r\n    }\r\n    return base;\r\n}\r\nexport function createMap(length, fn) {\r\n    return Array.from({ length }, typeof fn === \"function\" ? fn : defaultFill);\r\n}\r\nexport function createWorld() {\r\n    return createMap(MAP.width * MAP.height, mapGenerate);\r\n}\r\n","import { MAP } from \"./Config.js\";\r\nimport { applyBiome } from \"./Biome.js\";\r\nimport { createMap, createWorld } from \"./Base.js\";\r\n\r\nexport function generateMap() {\r\n    const mapData = createWorld();\r\n    mapData.splice(\r\n        MAP.victimRectStart,\r\n        0,\r\n        ...applyBiome(\r\n            mapData.splice(\r\n                MAP.victimRectStart,\r\n                MAP.victimRectEnd + 1 - MAP.victimRectStart\r\n            )\r\n        )\r\n    );\r\n    mapData.splice(\r\n        MAP.playerRectStart,\r\n        0,\r\n        ...applyBiome(\r\n            mapData.splice(\r\n                MAP.playerRectStart,\r\n                MAP.playerRectEnd + 1 - MAP.playerRectStart\r\n            )\r\n        )\r\n    );\r\n    return mapData;\r\n}\r\n","import { Tile } from \"./Base/Tile.js\";\r\nimport { childMount } from \"../../Hooks/Base/Mount.js\";\r\nimport { TILE_CHANNEL, TILE_QUEUE_CHANNEL } from \"../Config.js\";\r\nimport { shadow } from \"rolled/src/hook\";\r\n\r\nimport fs from \"fs\";\r\nimport { generateMap } from \"./Generator/index.js\";\r\n// import css from \"../../Assets/Css/MapLayout.css\";\r\n\r\nconst css = fs.readFileSync(\r\n    __dirname + \"../../../Assets/Css/MapLayout.css\",\r\n    \"utf8\"\r\n);\r\n\r\nexport const Map = (props, context) => {\r\n    const mapData = generateMap();\r\n    const queueData = Array.from({ length: 9 }, (v, k) => ({\r\n        nth: k,\r\n        type: \"player\",\r\n        disabled: false,\r\n    }));\r\n    childMount(context, \"hex-map\", Tile, TILE_CHANNEL, mapData);\r\n    childMount(context, \"hex-slot\", Tile, TILE_QUEUE_CHANNEL, queueData);\r\n\r\n    //  <link rel=\"stylesheet\" type=\"text/css\" href=\"${css}\">\r\n    return shadow`\r\n        <style>\r\n            ${css}\r\n            .disabled {\r\n                background-color: #bebebe !important;\r\n            }\r\n            .victim {\r\n                background-color: #5142f5 !important;\r\n            }\r\n            .hex {\r\n                position:relative;\r\n            }\r\n            .hex .hex-item {\r\n                position: absolute;\r\n                width: 100%;\r\n                height: 100%;\r\n                z-index:1;\r\n            }\r\n            .hex-item img {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n            .hex .hex-biome {\r\n                width:100%;\r\n                height:100%;\r\n                z-index:0;\r\n            }\r\n            .hex-root {\r\n                height: auto;\r\n            }\r\n        </style>\r\n        <div class=\"map-layer hex-root\">\r\n            <div class=\"hex-crop\">\r\n                <div class=\"hex-container\" #hex-map>\r\n                </div>\r\n            </div>\r\n            <div class=\"hex-crop\">\r\n                <div class=\"hex-container\" #hex-slot>\r\n                </div> \r\n            </div>\r\n        </div>\r\n    `;\r\n};\r\nexport default Map;\r\n","import { h } from \"rolled/src\";\r\nimport { CharacterTemplate } from \"../Character/Factory.js\";\r\nimport { useEventListener } from \"../../Hooks/Base/UseEventListener.js\";\r\nimport { useDrag } from \"../../Hooks/Base/UseDragDrop.js\";\r\nexport const CharacterGrid = ({ name }, context) => {\r\n    const characterName = \"Tank\";\r\n    const shopSlot = `\r\n        ${CharacterTemplate(characterName)}\r\n        <div class=\"flex-item\">\r\n            #children\r\n        </div>\r\n    `;\r\n    const $dom = h`<div class=\"flex-item character-item\" draggable #root>\r\n        ${!!name ? shopSlot : \"\"}\r\n    </div>`;\r\n    const { root } = $dom.collect();\r\n    useDrag(\r\n        context,\r\n        root,\r\n        () => characterName,\r\n        (context) => {\r\n            // @ts-ignore\r\n            context.update({});\r\n        }\r\n    );\r\n    return $dom;\r\n};\r\nexport default CharacterGrid;\r\n","import { SHOP_CHANNEL } from \"../Config.js\";\r\nimport { childMount } from \"../../Hooks/Base/Mount.js\";\r\nimport CharacterGrid from \"./CharacterGrid.js\";\r\nimport { h, fragment } from \"rolled/src\";\r\n\r\nconst sampleMockCharacter = {\r\n    name: \"Tank\",\r\n    lv: 1,\r\n};\r\nexport const Shop = (props, context) => {\r\n    childMount(\r\n        context,\r\n        \"root\",\r\n        CharacterGrid,\r\n        SHOP_CHANNEL,\r\n        Array.from({ length: 5 }, (v, k) => ({\r\n            ...sampleMockCharacter,\r\n            nth: k,\r\n        }))\r\n    );\r\n    return h`\r\n        <div class=\"flex-row shop-ui\" #root>\r\n        </div>\r\n    `;\r\n};\r\nexport default Shop;\r\n","import { dom } from \"rolled\";\r\nimport Map from \"./Map/index.js\";\r\nimport Shop from \"./Ui/Shop.js\";\r\nimport { reactiveMount, c, useEffect } from \"rolled/src/hook/basic\";\r\nconst { fragment, h } = dom;\r\nexport const Game = (props, context) => {\r\n    const $dom = h`\r\n        <div>    \r\n            <style>\r\n                .flex-row {\r\n                    display:flex;\r\n                    flex-direction:row;\r\n                }\r\n                .flex-item {\r\n                    height: 100%;\r\n                }\r\n                .shop-ui {\r\n                    outline: 1px solid  #bebebe;\r\n                    display:inline-flex;   \r\n                }\r\n            </style>\r\n            <div #root></div>\r\n        </div>\r\n    `;\r\n    useEffect(\r\n        context,\r\n        () => {\r\n            reactiveMount(context, \"root\", [\r\n                c(Map, {}, null),\r\n                c(Shop, {}, null),\r\n            ]);\r\n        },\r\n        []\r\n    );\r\n    return $dom;\r\n};\r\nexport default Game;\r\n","import { dom, hook, renderer, syntheticEvents } from \"rolled\";\r\nimport Game from \"./Component/Game.js\";\r\nconst { fragment, h } = dom;\r\nconst { render } = renderer;\r\nconst { c, useGlobalHook, reactiveMount } = hook;\r\nrender(document.getElementById(\"app\"), c(Game, {}, null));\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}